{"ast":null,"code":"import OpenAI from 'openai';\nconst openai = new OpenAI({\n  apiKey: process.env.REACT_APP_OPENAI_API_KEY,\n  dangerouslyAllowBrowser: true\n});\nconst AVAILABLE_SERVICES = [{\n  id: 'lambda',\n  name: 'AWS Lambda',\n  icon: '/aws-icons/lambda.png'\n}, {\n  id: 's3',\n  name: 'Amazon S3',\n  icon: '/aws-icons/s3.png'\n}, {\n  id: 'ec2',\n  name: 'Amazon EC2',\n  icon: '/aws-icons/ec2.png'\n}, {\n  id: 'ecs',\n  name: 'Amazon ECS',\n  icon: '/aws-icons/ecs.png'\n}, {\n  id: 'dynamodb',\n  name: 'Amazon DynamoDB',\n  icon: '/aws-icons/dynamodb.png'\n}, {\n  id: 'rds',\n  name: 'Amazon RDS',\n  icon: '/aws-icons/rds.png'\n}];\nconst generateArchitecture = async difficulty => {\n  try {\n    const completion = await openai.chat.completions.create({\n      model: \"gpt-4\",\n      messages: [{\n        role: \"system\",\n        content: `You are an AWS architecture expert. Respond only with a JSON object in this exact format:\n{\n  \"services\": [\"service1\", \"service2\"],\n  \"connections\": [{\"from\": \"service1\", \"to\": \"service2\"}],\n  \"missingServices\": [\n    {\n      \"position\": \"database layer\",\n      \"options\": [\n        {\n          \"service\": \"rds\",\n          \"costEfficiency\": 8.5,\n          \"explanation\": \"Most cost-effective for relational data\"\n        }\n      ]\n    }\n  ]\n}`\n      }, {\n        role: \"user\",\n        content: `Generate a random ${difficulty} AWS architecture with 3 missing services and rank the possible answers based on cost-efficiency. Use only these services: ${AVAILABLE_SERVICES.map(s => s.id).join(', ')}`\n      }],\n      temperature: 0.7\n    });\n    const aiSuggestion = JSON.parse(completion.choices[0].message.content);\n\n    // Map service IDs to full service objects\n    const getServiceById = id => AVAILABLE_SERVICES.find(s => s.id === id) || AVAILABLE_SERVICES[0];\n    return {\n      architecture: {\n        services: aiSuggestion.services.map(id => getServiceById(id)),\n        connections: aiSuggestion.connections\n      },\n      questions: aiSuggestion.missingServices.map(ms => ({\n        text: `Which service would be most cost-efficient for ${ms.position}?`,\n        position: ms.position,\n        missingServices: ms.options.map(opt => opt.service),\n        options: ms.options.map(opt => ({\n          ...getServiceById(opt.service),\n          costEfficiency: opt.costEfficiency,\n          explanation: opt.explanation\n        }))\n      }))\n    };\n  } catch (error) {\n    console.error('AI Error:', error);\n    // Enhanced fallback with multiple missing services\n    const randomServices = AVAILABLE_SERVICES.sort(() => 0.5 - Math.random());\n    const baseServices = randomServices.slice(0, 4);\n    const missingServices = randomServices.slice(4, 7);\n    return {\n      architecture: {\n        services: baseServices,\n        connections: [{\n          from: baseServices[0].id,\n          to: baseServices[1].id\n        }, {\n          from: baseServices[1].id,\n          to: baseServices[2].id\n        }, {\n          from: baseServices[2].id,\n          to: baseServices[3].id\n        }]\n      },\n      questions: missingServices.map((service, index) => ({\n        text: `Which service would you add for position ${index + 1}?`,\n        position: `Position ${index + 1}`,\n        missingServices: [service.id],\n        options: randomServices.slice(0, 4).map(s => ({\n          ...s,\n          costEfficiency: Math.random() * 10,\n          explanation: `${s.name} could be used here`\n        }))\n      }))\n    };\n  }\n};\nexport { generateArchitecture };","map":{"version":3,"names":["OpenAI","openai","apiKey","process","env","REACT_APP_OPENAI_API_KEY","dangerouslyAllowBrowser","AVAILABLE_SERVICES","id","name","icon","generateArchitecture","difficulty","completion","chat","completions","create","model","messages","role","content","map","s","join","temperature","aiSuggestion","JSON","parse","choices","message","getServiceById","find","architecture","services","connections","questions","missingServices","ms","text","position","options","opt","service","costEfficiency","explanation","error","console","randomServices","sort","Math","random","baseServices","slice","from","to","index"],"sources":["/Users/eimis/test-server/react_projects/cloud-architecture-game/src/services/AWSArchitectureAI.js"],"sourcesContent":["import OpenAI from 'openai';\n\nconst openai = new OpenAI({\n  apiKey: process.env.REACT_APP_OPENAI_API_KEY,\n  dangerouslyAllowBrowser: true\n});\n\nconst AVAILABLE_SERVICES = [\n  { id: 'lambda', name: 'AWS Lambda', icon: '/aws-icons/lambda.png' },\n  { id: 's3', name: 'Amazon S3', icon: '/aws-icons/s3.png' },\n  { id: 'ec2', name: 'Amazon EC2', icon: '/aws-icons/ec2.png' },\n  { id: 'ecs', name: 'Amazon ECS', icon: '/aws-icons/ecs.png' },\n  { id: 'dynamodb', name: 'Amazon DynamoDB', icon: '/aws-icons/dynamodb.png' },\n  { id: 'rds', name: 'Amazon RDS', icon: '/aws-icons/rds.png' }\n];\n\nconst generateArchitecture = async (difficulty) => {\n  try {\n    const completion = await openai.chat.completions.create({\n      model: \"gpt-4\",\n      messages: [\n        { \n          role: \"system\", \n          content: `You are an AWS architecture expert. Respond only with a JSON object in this exact format:\n{\n  \"services\": [\"service1\", \"service2\"],\n  \"connections\": [{\"from\": \"service1\", \"to\": \"service2\"}],\n  \"missingServices\": [\n    {\n      \"position\": \"database layer\",\n      \"options\": [\n        {\n          \"service\": \"rds\",\n          \"costEfficiency\": 8.5,\n          \"explanation\": \"Most cost-effective for relational data\"\n        }\n      ]\n    }\n  ]\n}`\n        },\n        {\n          role: \"user\",\n          content: `Generate a random ${difficulty} AWS architecture with 3 missing services and rank the possible answers based on cost-efficiency. Use only these services: ${AVAILABLE_SERVICES.map(s => s.id).join(', ')}`\n        }\n      ],\n      temperature: 0.7\n    });\n\n    const aiSuggestion = JSON.parse(completion.choices[0].message.content);\n    \n    // Map service IDs to full service objects\n    const getServiceById = (id) => AVAILABLE_SERVICES.find(s => s.id === id) || AVAILABLE_SERVICES[0];\n\n    return {\n      architecture: {\n        services: aiSuggestion.services.map(id => getServiceById(id)),\n        connections: aiSuggestion.connections\n      },\n      questions: aiSuggestion.missingServices.map(ms => ({\n        text: `Which service would be most cost-efficient for ${ms.position}?`,\n        position: ms.position,\n        missingServices: ms.options.map(opt => opt.service),\n        options: ms.options.map(opt => ({\n          ...getServiceById(opt.service),\n          costEfficiency: opt.costEfficiency,\n          explanation: opt.explanation\n        }))\n      }))\n    };\n\n  } catch (error) {\n    console.error('AI Error:', error);\n    // Enhanced fallback with multiple missing services\n    const randomServices = AVAILABLE_SERVICES.sort(() => 0.5 - Math.random());\n    const baseServices = randomServices.slice(0, 4);\n    const missingServices = randomServices.slice(4, 7);\n\n    return {\n      architecture: {\n        services: baseServices,\n        connections: [\n          { from: baseServices[0].id, to: baseServices[1].id },\n          { from: baseServices[1].id, to: baseServices[2].id },\n          { from: baseServices[2].id, to: baseServices[3].id }\n        ]\n      },\n      questions: missingServices.map((service, index) => ({\n        text: `Which service would you add for position ${index + 1}?`,\n        position: `Position ${index + 1}`,\n        missingServices: [service.id],\n        options: randomServices.slice(0, 4).map(s => ({\n          ...s,\n          costEfficiency: Math.random() * 10,\n          explanation: `${s.name} could be used here`\n        }))\n      }))\n    };\n  }\n};\n\nexport { generateArchitecture }; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}