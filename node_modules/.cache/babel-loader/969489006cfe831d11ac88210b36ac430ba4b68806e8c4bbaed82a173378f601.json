{"ast":null,"code":"import OpenAI from 'openai';\nconst openai = new OpenAI({\n  apiKey: process.env.REACT_APP_OPENAI_API_KEY,\n  dangerouslyAllowBrowser: true\n});\nconst AVAILABLE_SERVICES = [{\n  id: 'lambda',\n  name: 'AWS Lambda',\n  icon: '/aws-icons/lambda.png'\n}, {\n  id: 's3',\n  name: 'Amazon S3',\n  icon: '/aws-icons/s3.png'\n}, {\n  id: 'ec2',\n  name: 'Amazon EC2',\n  icon: '/aws-icons/ec2.png'\n}, {\n  id: 'ecs',\n  name: 'Amazon ECS',\n  icon: '/aws-icons/ecs.png'\n}, {\n  id: 'dynamodb',\n  name: 'Amazon DynamoDB',\n  icon: '/aws-icons/dynamodb.png'\n}, {\n  id: 'rds',\n  name: 'Amazon RDS',\n  icon: '/aws-icons/rds.png'\n}];\nconst generateArchitecture = async difficulty => {\n  try {\n    const completion = await openai.chat.completions.create({\n      model: \"gpt-4\",\n      messages: [{\n        role: \"system\",\n        content: \"You are an AWS architecture expert. Generate random architectures with multiple missing services and rank possible solutions by cost-efficiency.\"\n      }, {\n        role: \"user\",\n        content: `Generate a random ${difficulty} AWS architecture with 3 missing services and rank the possible answers based on cost-efficiency. Use only these services: ${AVAILABLE_SERVICES.map(s => s.id).join(', ')}`\n      }],\n      response_format: {\n        type: \"json_schema\",\n        json_schema: {\n          name: \"aws_architecture_schema\",\n          schema: {\n            type: \"object\",\n            properties: {\n              services: {\n                type: \"array\",\n                items: {\n                  type: \"string\"\n                }\n              },\n              connections: {\n                type: \"array\",\n                items: {\n                  type: \"object\",\n                  properties: {\n                    from: {\n                      type: \"string\"\n                    },\n                    to: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              },\n              missingServices: {\n                type: \"array\",\n                items: {\n                  type: \"object\",\n                  properties: {\n                    position: {\n                      type: \"string\"\n                    },\n                    options: {\n                      type: \"array\",\n                      items: {\n                        type: \"object\",\n                        properties: {\n                          service: {\n                            type: \"string\"\n                          },\n                          costEfficiency: {\n                            type: \"number\"\n                          },\n                          explanation: {\n                            type: \"string\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            },\n            required: [\"services\", \"connections\", \"missingServices\"]\n          }\n        }\n      }\n    });\n    const aiSuggestion = JSON.parse(completion.choices[0].message.content);\n\n    // Map service IDs to full service objects\n    const getServiceById = id => AVAILABLE_SERVICES.find(s => s.id === id) || AVAILABLE_SERVICES[0];\n    return {\n      architecture: {\n        services: aiSuggestion.services.map(id => getServiceById(id)),\n        connections: aiSuggestion.connections\n      },\n      questions: aiSuggestion.missingServices.map(ms => ({\n        text: `Which service would be most cost-efficient for ${ms.position}?`,\n        position: ms.position,\n        missingServices: ms.options.map(opt => opt.service),\n        options: ms.options.map(opt => ({\n          ...getServiceById(opt.service),\n          costEfficiency: opt.costEfficiency,\n          explanation: opt.explanation\n        }))\n      }))\n    };\n  } catch (error) {\n    console.error('AI Error:', error);\n    // Fallback with multiple missing services\n    const randomServices = AVAILABLE_SERVICES.sort(() => 0.5 - Math.random());\n    const baseServices = randomServices.slice(0, 4);\n    const missingServices = randomServices.slice(4, 7);\n    return {\n      architecture: {\n        services: baseServices,\n        connections: [{\n          from: baseServices[0].id,\n          to: baseServices[1].id\n        }, {\n          from: baseServices[1].id,\n          to: baseServices[2].id\n        }, {\n          from: baseServices[2].id,\n          to: baseServices[3].id\n        }]\n      },\n      questions: missingServices.map((service, index) => ({\n        text: `Which service would you add for position ${index + 1}?`,\n        position: `Position ${index + 1}`,\n        missingServices: [service.id],\n        options: randomServices.slice(0, 4).map(s => ({\n          ...s,\n          costEfficiency: Math.random() * 10,\n          explanation: `${s.name} could be used here`\n        }))\n      }))\n    };\n  }\n};\nexport { generateArchitecture };","map":{"version":3,"names":["OpenAI","openai","apiKey","process","env","REACT_APP_OPENAI_API_KEY","dangerouslyAllowBrowser","AVAILABLE_SERVICES","id","name","icon","generateArchitecture","difficulty","completion","chat","completions","create","model","messages","role","content","map","s","join","response_format","type","json_schema","schema","properties","services","items","connections","from","to","missingServices","position","options","service","costEfficiency","explanation","required","aiSuggestion","JSON","parse","choices","message","getServiceById","find","architecture","questions","ms","text","opt","error","console","randomServices","sort","Math","random","baseServices","slice","index"],"sources":["/Users/eimis/test-server/react_projects/cloud-architecture-game/src/services/AWSArchitectureAI.js"],"sourcesContent":["import OpenAI from 'openai';\n\nconst openai = new OpenAI({\n  apiKey: process.env.REACT_APP_OPENAI_API_KEY,\n  dangerouslyAllowBrowser: true\n});\n\nconst AVAILABLE_SERVICES = [\n  { id: 'lambda', name: 'AWS Lambda', icon: '/aws-icons/lambda.png' },\n  { id: 's3', name: 'Amazon S3', icon: '/aws-icons/s3.png' },\n  { id: 'ec2', name: 'Amazon EC2', icon: '/aws-icons/ec2.png' },\n  { id: 'ecs', name: 'Amazon ECS', icon: '/aws-icons/ecs.png' },\n  { id: 'dynamodb', name: 'Amazon DynamoDB', icon: '/aws-icons/dynamodb.png' },\n  { id: 'rds', name: 'Amazon RDS', icon: '/aws-icons/rds.png' }\n];\n\nconst generateArchitecture = async (difficulty) => {\n  try {\n    const completion = await openai.chat.completions.create({\n      model: \"gpt-4\",\n      messages: [\n        { \n          role: \"system\", \n          content: \"You are an AWS architecture expert. Generate random architectures with multiple missing services and rank possible solutions by cost-efficiency.\"\n        },\n        {\n          role: \"user\",\n          content: `Generate a random ${difficulty} AWS architecture with 3 missing services and rank the possible answers based on cost-efficiency. Use only these services: ${AVAILABLE_SERVICES.map(s => s.id).join(', ')}`\n        }\n      ],\n      response_format: {\n        type: \"json_schema\",\n        json_schema: {\n          name: \"aws_architecture_schema\",\n          schema: {\n            type: \"object\",\n            properties: {\n              services: {\n                type: \"array\",\n                items: { type: \"string\" }\n              },\n              connections: {\n                type: \"array\",\n                items: {\n                  type: \"object\",\n                  properties: {\n                    from: { type: \"string\" },\n                    to: { type: \"string\" }\n                  }\n                }\n              },\n              missingServices: {\n                type: \"array\",\n                items: {\n                  type: \"object\",\n                  properties: {\n                    position: { type: \"string\" },\n                    options: {\n                      type: \"array\",\n                      items: {\n                        type: \"object\",\n                        properties: {\n                          service: { type: \"string\" },\n                          costEfficiency: { type: \"number\" },\n                          explanation: { type: \"string\" }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            },\n            required: [\"services\", \"connections\", \"missingServices\"]\n          }\n        }\n      }\n    });\n\n    const aiSuggestion = JSON.parse(completion.choices[0].message.content);\n    \n    // Map service IDs to full service objects\n    const getServiceById = (id) => AVAILABLE_SERVICES.find(s => s.id === id) || AVAILABLE_SERVICES[0];\n\n    return {\n      architecture: {\n        services: aiSuggestion.services.map(id => getServiceById(id)),\n        connections: aiSuggestion.connections\n      },\n      questions: aiSuggestion.missingServices.map(ms => ({\n        text: `Which service would be most cost-efficient for ${ms.position}?`,\n        position: ms.position,\n        missingServices: ms.options.map(opt => opt.service),\n        options: ms.options.map(opt => ({\n          ...getServiceById(opt.service),\n          costEfficiency: opt.costEfficiency,\n          explanation: opt.explanation\n        }))\n      }))\n    };\n\n  } catch (error) {\n    console.error('AI Error:', error);\n    // Fallback with multiple missing services\n    const randomServices = AVAILABLE_SERVICES.sort(() => 0.5 - Math.random());\n    const baseServices = randomServices.slice(0, 4);\n    const missingServices = randomServices.slice(4, 7);\n\n    return {\n      architecture: {\n        services: baseServices,\n        connections: [\n          { from: baseServices[0].id, to: baseServices[1].id },\n          { from: baseServices[1].id, to: baseServices[2].id },\n          { from: baseServices[2].id, to: baseServices[3].id }\n        ]\n      },\n      questions: missingServices.map((service, index) => ({\n        text: `Which service would you add for position ${index + 1}?`,\n        position: `Position ${index + 1}`,\n        missingServices: [service.id],\n        options: randomServices.slice(0, 4).map(s => ({\n          ...s,\n          costEfficiency: Math.random() * 10,\n          explanation: `${s.name} could be used here`\n        }))\n      }))\n    };\n  }\n};\n\nexport { generateArchitecture }; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}