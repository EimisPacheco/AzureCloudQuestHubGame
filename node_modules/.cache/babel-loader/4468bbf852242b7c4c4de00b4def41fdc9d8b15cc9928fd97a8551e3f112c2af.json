{"ast":null,"code":"import OpenAI from 'openai';\nconst openai = new OpenAI({\n  apiKey: process.env.REACT_APP_OPENAI_API_KEY,\n  dangerouslyAllowBrowser: true\n});\nconst AVAILABLE_SERVICES = [{\n  id: 'lambda',\n  name: 'AWS Lambda',\n  icon: '/aws-icons/lambda.png'\n}, {\n  id: 's3',\n  name: 'Amazon S3',\n  icon: '/aws-icons/s3.png'\n}, {\n  id: 'ec2',\n  name: 'Amazon EC2',\n  icon: '/aws-icons/ec2.png'\n}, {\n  id: 'ecs',\n  name: 'Amazon ECS',\n  icon: '/aws-icons/ecs.png'\n}, {\n  id: 'dynamodb',\n  name: 'Amazon DynamoDB',\n  icon: '/aws-icons/dynamodb.png'\n}, {\n  id: 'rds',\n  name: 'Amazon RDS',\n  icon: '/aws-icons/rds.png'\n}];\nconst generateArchitecture = async difficulty => {\n  try {\n    const completion = await openai.chat.completions.create({\n      model: \"gpt-4\",\n      messages: [{\n        role: \"system\",\n        content: \"You are an AWS architecture expert. Generate random architectures with multiple missing services and rank possible solutions by cost-efficiency.\"\n      }, {\n        role: \"user\",\n        content: `Generate a random ${difficulty} AWS architecture with 3 missing services and rank the possible answers based on cost-efficiency.`\n      }],\n      response_format: {\n        type: \"json_schema\",\n        schema: {\n          type: \"object\",\n          properties: {\n            services: {\n              type: \"array\",\n              items: {\n                type: \"string\"\n              }\n            },\n            connections: {\n              type: \"array\",\n              items: {\n                type: \"object\",\n                properties: {\n                  from: {\n                    type: \"string\"\n                  },\n                  to: {\n                    type: \"string\"\n                  }\n                }\n              }\n            },\n            missingServices: {\n              type: \"array\",\n              items: {\n                type: \"object\",\n                properties: {\n                  position: {\n                    type: \"string\"\n                  },\n                  options: {\n                    type: \"array\",\n                    items: {\n                      type: \"object\",\n                      properties: {\n                        service: {\n                          type: \"string\"\n                        },\n                        costEfficiency: {\n                          type: \"number\"\n                        },\n                        explanation: {\n                          type: \"string\"\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    });\n    const aiSuggestion = JSON.parse(completion.choices[0].message.content);\n\n    // Map service IDs to full service objects\n    const getServiceById = id => AVAILABLE_SERVICES.find(s => s.id === id) || AVAILABLE_SERVICES[0];\n    return {\n      architecture: {\n        services: aiSuggestion.services.map(id => getServiceById(id)),\n        connections: aiSuggestion.connections\n      },\n      questions: aiSuggestion.missingServices.map(ms => ({\n        text: `Which service would be most cost-efficient for ${ms.position}?`,\n        position: ms.position,\n        missingServices: ms.options.map(opt => opt.service),\n        options: ms.options.map(opt => ({\n          ...getServiceById(opt.service),\n          costEfficiency: opt.costEfficiency,\n          explanation: opt.explanation\n        }))\n      }))\n    };\n  } catch (error) {\n    console.error('AI Error:', error);\n    // Enhanced fallback with multiple missing services\n    const randomServices = AVAILABLE_SERVICES.sort(() => 0.5 - Math.random());\n    const baseServices = randomServices.slice(0, 4);\n    const missingServices = randomServices.slice(4, 7);\n    return {\n      architecture: {\n        services: baseServices,\n        connections: [{\n          from: baseServices[0].id,\n          to: baseServices[1].id\n        }, {\n          from: baseServices[1].id,\n          to: baseServices[2].id\n        }, {\n          from: baseServices[2].id,\n          to: baseServices[3].id\n        }]\n      },\n      questions: missingServices.map((service, index) => ({\n        text: `Which service would you add for position ${index + 1}?`,\n        position: `Position ${index + 1}`,\n        missingServices: [service.id],\n        options: randomServices.slice(0, 4).map(s => ({\n          ...s,\n          costEfficiency: Math.random() * 10,\n          explanation: `${s.name} could be used here`\n        }))\n      }))\n    };\n  }\n};\nexport { generateArchitecture };","map":{"version":3,"names":["OpenAI","openai","apiKey","process","env","REACT_APP_OPENAI_API_KEY","dangerouslyAllowBrowser","AVAILABLE_SERVICES","id","name","icon","generateArchitecture","difficulty","completion","chat","completions","create","model","messages","role","content","response_format","type","schema","properties","services","items","connections","from","to","missingServices","position","options","service","costEfficiency","explanation","aiSuggestion","JSON","parse","choices","message","getServiceById","find","s","architecture","map","questions","ms","text","opt","error","console","randomServices","sort","Math","random","baseServices","slice","index"],"sources":["/Users/eimis/test-server/react_projects/cloud-architecture-game/src/services/AWSArchitectureAI.js"],"sourcesContent":["import OpenAI from 'openai';\n\nconst openai = new OpenAI({\n  apiKey: process.env.REACT_APP_OPENAI_API_KEY,\n  dangerouslyAllowBrowser: true\n});\n\nconst AVAILABLE_SERVICES = [\n  { id: 'lambda', name: 'AWS Lambda', icon: '/aws-icons/lambda.png' },\n  { id: 's3', name: 'Amazon S3', icon: '/aws-icons/s3.png' },\n  { id: 'ec2', name: 'Amazon EC2', icon: '/aws-icons/ec2.png' },\n  { id: 'ecs', name: 'Amazon ECS', icon: '/aws-icons/ecs.png' },\n  { id: 'dynamodb', name: 'Amazon DynamoDB', icon: '/aws-icons/dynamodb.png' },\n  { id: 'rds', name: 'Amazon RDS', icon: '/aws-icons/rds.png' }\n];\n\nconst generateArchitecture = async (difficulty) => {\n  try {\n    const completion = await openai.chat.completions.create({\n      model: \"gpt-4\",\n      messages: [\n        { \n          role: \"system\", \n          content: \"You are an AWS architecture expert. Generate random architectures with multiple missing services and rank possible solutions by cost-efficiency.\"\n        },\n        {\n          role: \"user\",\n          content: `Generate a random ${difficulty} AWS architecture with 3 missing services and rank the possible answers based on cost-efficiency.`\n        }\n      ],\n      response_format: {\n        type: \"json_schema\",\n        schema: {\n          type: \"object\",\n          properties: {\n            services: {\n              type: \"array\",\n              items: { type: \"string\" }\n            },\n            connections: {\n              type: \"array\",\n              items: {\n                type: \"object\",\n                properties: {\n                  from: { type: \"string\" },\n                  to: { type: \"string\" }\n                }\n              }\n            },\n            missingServices: {\n              type: \"array\",\n              items: {\n                type: \"object\",\n                properties: {\n                  position: { type: \"string\" },\n                  options: {\n                    type: \"array\",\n                    items: {\n                      type: \"object\",\n                      properties: {\n                        service: { type: \"string\" },\n                        costEfficiency: { type: \"number\" },\n                        explanation: { type: \"string\" }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    });\n\n    const aiSuggestion = JSON.parse(completion.choices[0].message.content);\n    \n    // Map service IDs to full service objects\n    const getServiceById = (id) => AVAILABLE_SERVICES.find(s => s.id === id) || AVAILABLE_SERVICES[0];\n\n    return {\n      architecture: {\n        services: aiSuggestion.services.map(id => getServiceById(id)),\n        connections: aiSuggestion.connections\n      },\n      questions: aiSuggestion.missingServices.map(ms => ({\n        text: `Which service would be most cost-efficient for ${ms.position}?`,\n        position: ms.position,\n        missingServices: ms.options.map(opt => opt.service),\n        options: ms.options.map(opt => ({\n          ...getServiceById(opt.service),\n          costEfficiency: opt.costEfficiency,\n          explanation: opt.explanation\n        }))\n      }))\n    };\n\n  } catch (error) {\n    console.error('AI Error:', error);\n    // Enhanced fallback with multiple missing services\n    const randomServices = AVAILABLE_SERVICES.sort(() => 0.5 - Math.random());\n    const baseServices = randomServices.slice(0, 4);\n    const missingServices = randomServices.slice(4, 7);\n\n    return {\n      architecture: {\n        services: baseServices,\n        connections: [\n          { from: baseServices[0].id, to: baseServices[1].id },\n          { from: baseServices[1].id, to: baseServices[2].id },\n          { from: baseServices[2].id, to: baseServices[3].id }\n        ]\n      },\n      questions: missingServices.map((service, index) => ({\n        text: `Which service would you add for position ${index + 1}?`,\n        position: `Position ${index + 1}`,\n        missingServices: [service.id],\n        options: randomServices.slice(0, 4).map(s => ({\n          ...s,\n          costEfficiency: Math.random() * 10,\n          explanation: `${s.name} could be used here`\n        }))\n      }))\n    };\n  }\n};\n\nexport { generateArchitecture }; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}